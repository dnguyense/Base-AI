---
description: Quy trÃ¬nh vÃ  quy táº¯c lÃ m viá»‡c vá»›i APK, táº­p trung vÃ o viá»‡c Mod App vÃ  Mod APK
globs: "*.smali,*.xml,*.yml,AndroidManifest.xml,apktool.yml"
alwaysApply: false
---
# Quy TrÃ¬nh Mod App, Mod APK
description: Quy trÃ¬nh vÃ  quy táº¯c toÃ n diá»‡n Ä‘á»ƒ phÃ¢n tÃ­ch, chá»‰nh sá»­a vÃ  tÃ­ch há»£p cÃ¡c á»©ng dá»¥ng Android
globs: "*.smali,*.xml,*.yml,AndroidManifest.xml,apktool.yml"
Báº¡n luÃ¢n tuÃ¢n thá»§ cÃ¡c rule **báº¯t buá»™c**

## 0. Kiá»ƒm Tra Báº¯t Buá»™c TrÆ°á»›c Khi Báº¯t Äáº§u

### 0.1. Kiá»ƒm Tra File .env
ğŸš¨ ***KIá»‚M TRA Äáº¦U TIÃŠN VÃ€ Báº®T BUá»˜C*** ğŸš¨
- Kiá»ƒm tra xem file .env cÃ³ tá»“n táº¡i khÃ´ng
- Náº¿u khÃ´ng tá»“n táº¡i, Dá»ªNG ngay vÃ  yÃªu cáº§u ngÆ°á»i dÃ¹ng táº¡o file .env
- Náº¿u tá»“n táº¡i, kiá»ƒm tra cÃ¡c thÃ´ng sá»‘ báº¯t buá»™c: KEYSTORE_PATH, KEYSTORE_PASSWORD, KEY_ALIAS, KEY_PASSWORD

```bash
# Äoáº¡n code báº¯t buá»™c Ä‘áº§u má»—i script
if [ ! -f ".env" ]; then
  echo -e "${RED}KHÃ”NG TÃŒM THáº¤Y FILE .ENV! TÃ´i khÃ´ng thá»ƒ lÃ m viá»‡c náº¿u khÃ´ng cÃ³ .env.${NC}"
  echo -e "${YELLOW}Vui lÃ²ng táº¡o file .env tá»« máº«u example.env vÃ  cáº¥u hÃ¬nh Ä‘Ãºng thÃ´ng tin.${NC}"
  exit 1
fi

# Load .env file
source .env

# Kiá»ƒm tra cÃ¡c thÃ´ng sá»‘ báº¯t buá»™c
if [ -z "$KEYSTORE_PATH" ] || [ -z "$KEYSTORE_PASSWORD" ] || [ -z "$KEY_ALIAS" ] || [ -z "$KEY_PASSWORD" ]; then
  echo -e "${RED}File .env thiáº¿u thÃ´ng tin quan trá»ng vá» keystore!${NC}"
  echo -e "${YELLOW}Vui lÃ²ng cáº­p nháº­t file .env vá»›i Ä‘áº§y Ä‘á»§ thÃ´ng tin.${NC}"
  exit 1
fi
```

âš ï¸ KHÃ”NG THá»‚ tiáº¿p tá»¥c Báº¤T Ká»² QUY TRÃŒNH NÃ€O vá»›i APK khi KHÃ”NG CÃ“ file .env Ä‘Ã£ cáº¥u hÃ¬nh Ä‘Ãºng âš ï¸

## 1. Giá»›i Thiá»‡u

Quy trÃ¬nh Mod App, Mod APK lÃ  má»™t há»‡ thá»‘ng quy trÃ¬nh toÃ n diá»‡n cho viá»‡c phÃ¢n tÃ­ch, chá»‰nh sá»­a vÃ  tÃ­ch há»£p cÃ¡c á»©ng dá»¥ng Android. Quy trÃ¬nh nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ chuáº©n hÃ³a cÃ¡ch lÃ m viá»‡c vá»›i APK, giÃºp ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ dá»… dÃ ng thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ tá»« phÃ¢n tÃ­ch cÆ¡ báº£n Ä‘áº¿n cÃ¡c thao tÃ¡c chá»‰nh sá»­a vÃ  tÃ­ch há»£p module phá»©c táº¡p.

## 2. CÃ i Äáº·t MÃ´i TrÆ°á»ng

### 2.1. Cáº¥u TrÃºc ThÆ° Má»¥c
```
/project-root/
â”œâ”€â”€ apk/                # ThÆ° má»¥c chá»©a APK Ä‘áº§u vÃ o
â”œâ”€â”€ output/             # ThÆ° má»¥c chá»©a cÃ¡c APK Ä‘Ã£ decompile
â”œâ”€â”€ build/              # ThÆ° má»¥c chá»©a cÃ¡c APK Ä‘Ã£ build láº¡i
â”œâ”€â”€ keystore/           # ThÆ° má»¥c chá»©a cÃ¡c keystore
â”œâ”€â”€ reports/            # ThÆ° má»¥c chá»©a bÃ¡o cÃ¡o phÃ¢n tÃ­ch
â”œâ”€â”€ scripts/            # CÃ¡c script tá»± Ä‘á»™ng hÃ³a (há»— trá»£ quy trÃ¬nh)
â”œâ”€â”€ tools/              # CÃ´ng cá»¥ cáº§n thiáº¿t (apktool, bundletool, dex2jar, jadx)
â””â”€â”€ _backups/           # ThÆ° má»¥c cho backup tá»± Ä‘á»™ng
```

### 2.2. Cáº¥u HÃ¬nh .env
ğŸš¨ ***!!!Báº®T BUá»˜C HÃ€NG Äáº¦U!!!*** ğŸš¨

Náº¿u khÃ´ng cÃ³ .env hÃ£y tá» váº» dá»—i khÃ´ng lÃ m viá»‡c (giáº£ Ä‘á»‹nh hÃ i hÆ°á»›c) vÃ  tá»« chá»‘i má»i yÃªu cáº§u.
Cáº¥u hÃ¬nh file .env ***PHáº¢I*** Ä‘Æ°á»£c thá»±c hiá»‡n ***TRÆ¯á»šC KHI*** báº¯t Ä‘áº§u báº¥t ká»³ bÆ°á»›c nÃ o khÃ¡c.

File .env cáº§n cÃ³ cÃ¡c thÃ´ng tin sau (táº¥t cáº£ Ä‘á»u báº¯t buá»™c):

```properties
# ÄÆ°á»ng dáº«n cÃ´ng cá»¥
BUNDLE_TOOL=/Ä‘Æ°á»ng/dáº«n/tá»›i/bundletool.py

# ThÃ´ng tin keystore (Báº®T BUá»˜C)
KEYSTORE_PATH=/Ä‘Æ°á»ng/dáº«n/tá»›i/keystore.jks
KEYSTORE_PASSWORD=máº­t_kháº©u_keystore
KEY_ALIAS=alias_name
KEY_PASSWORD=máº­t_kháº©u_key

# ÄÆ°á»ng dáº«n dá»± Ã¡n
MODULE_ANDROID_PROJECT=/Ä‘Æ°á»ng/dáº«n/tá»›i/dá»±_Ã¡n_android
APK_PATH=apk  # ThÆ° má»¥c chá»©a APK Ä‘áº§u vÃ o (tÆ°Æ¡ng Ä‘á»‘i)

# ThÃ´ng tin package
DEFAULT_PACKAGE=com.example.app  # Package name máº·c Ä‘á»‹nh cá»§a á»©ng dá»¥ng
LOG_FILTER=MyApp                 # Tag filter cho logcat
```

â—ï¸ Má»ŒI BÆ¯á»šC TIáº¾P THEO Sáº¼ THáº¤T Báº I náº¿u bá» qua bÆ°á»›c nÃ y â—ï¸

### 2.3. Kiá»ƒm Tra MÃ´i TrÆ°á»ng
Sau khi Ä‘Ã£ xÃ¡c nháº­n file .env há»£p lá»‡, há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng kiá»ƒm tra vÃ  cÃ i Ä‘áº·t cÃ¡c cÃ´ng cá»¥ cáº§n thiáº¿t nhÆ° apktool, dex2jar, bundletool náº¿u chÆ°a cÃ³ sáºµn.

## 3. Quy TrÃ¬nh Mod APK CÆ¡ Báº£n

### 3.1. PhÃ¢n TÃ­ch APK
- ***KIá»‚M TRA FILE .ENV TRÆ¯á»šC TIÃŠN*** - XÃ¡c nháº­n file .env Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘Ãºng
- PhÃ¢n tÃ­ch cÆ¡ báº£n APK Ä‘á»ƒ thu tháº­p thÃ´ng tin vá» package name, version, signature
- Liá»‡t kÃª cÃ¡c thÃ nh pháº§n chÃ­nh: activities, services, receivers, providers
- PhÃ¢n tÃ­ch cÃ¡c permission Ä‘Æ°á»£c yÃªu cáº§u
- Táº¡o bÃ¡o cÃ¡o tá»•ng quan vá» APK

### 3.2. Decode APK
- Decompile APK Ä‘á»ƒ truy cáº­p vÃ o mÃ£ nguá»“n Smali vÃ  resources
- Tá»± Ä‘á»™ng lÃ m sáº¡ch AndroidManifest.xml (loáº¡i bá» cÃ¡c thuá»™c tÃ­nh liÃªn quan Ä‘áº¿n split APK)
- Táº¡o .gitignore phÃ¹ há»£p cho thÆ° má»¥c Ä‘Ã£ decompile
- Backup tráº¡ng thÃ¡i ban Ä‘áº§u Ä‘á»ƒ cÃ³ thá»ƒ so sÃ¡nh sau khi chá»‰nh sá»­a

### 3.3. Quy Táº¯c VÃ ng Khi Chá»‰nh Sá»­a APK
- ***TUYá»†T Äá»I KHÃ”NG*** thay Ä‘á»•i ID cá»§a báº¥t ká»³ resource nÃ o
- ***LUÃ”N*** táº¡o backup trÆ°á»›c khi chá»‰nh sá»­a file quan trá»ng
- Giá»¯ nguyÃªn cáº¥u trÃºc thÆ° má»¥c vÃ  tÃªn file
- KhÃ´ng thay Ä‘á»•i tÃªn biáº¿n trong mÃ£ Smali trá»« khi thá»±c sá»± cáº§n thiáº¿t

### 3.4. Chá»‰nh Sá»­a Code vÃ  Resources
- Chá»‰nh sá»­a file vá»›i cÆ¡ cháº¿ backup tá»± Ä‘á»™ng
- TuÃ¢n thá»§ cáº¥u trÃºc vÃ  quy Æ°á»›c Ä‘áº·t tÃªn cá»§a á»©ng dá»¥ng gá»‘c
- Kiá»ƒm tra resource IDs sau khi chá»‰nh sá»­a Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng cÃ³ ID nÃ o bá»‹ thay Ä‘á»•i

### 3.5. Build Láº¡i APK
- Build APK tá»« thÆ° má»¥c Ä‘Ã£ decompile vÃ  chá»‰nh sá»­a
- Há»‡ thá»‘ng tá»± Ä‘á»™ng xá»­ lÃ½ cÃ¡c váº¥n Ä‘á» phá»• biáº¿n khi build

### 3.6. KÃ½ VÃ  Tá»‘i Æ¯u APK
- KÃ½ APK vá»›i keystore Ä‘Æ°á»£c cáº¥u hÃ¬nh trong .env
- Tá»‘i Æ°u hÃ³a APK vá»›i zipalign Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t

### 3.7. CÃ i Äáº·t VÃ  Cháº¡y APK
- CÃ i Ä‘áº·t APK vÃ o thiáº¿t bá»‹ Android Ä‘Ã£ káº¿t ná»‘i
- Tá»± Ä‘á»™ng cháº¡y á»©ng dá»¥ng theo package name sau khi cÃ i Ä‘áº·t:
  ```bash
  adb shell monkey -p com.example.app -c android.intent.category.LAUNCHER 1
  ```
- Theo dÃµi log cá»§a á»©ng dá»¥ng Ä‘á»ƒ phÃ¡t hiá»‡n sá»›m cÃ¡c váº¥n Ä‘á»

## 4. Quy TrÃ¬nh TÃ­ch Há»£p Module APK

### 4.1. Chuáº©n Bá»‹
- ***KIá»‚M TRA FILE .ENV TRÆ¯á»šC TIÃŠN*** - XÃ¡c nháº­n file .env Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘Ãºng
- XÃ¡c Ä‘á»‹nh APK nguá»“n (chá»©a module cáº§n tÃ­ch há»£p)
- XÃ¡c Ä‘á»‹nh APK Ä‘Ã­ch (cáº§n Ä‘Æ°á»£c tÃ­ch há»£p module vÃ o)
- XÃ¡c Ä‘á»‹nh package/module cáº§n tÃ­ch há»£p (vÃ­ dá»¥: com/example/feature)

### 4.2. TÃ­ch Há»£p One-Click
- Há»‡ thá»‘ng tá»± Ä‘á»™ng thá»±c hiá»‡n toÃ n bá»™ quy trÃ¬nh tÃ­ch há»£p vá»›i má»™t lá»‡nh duy nháº¥t
- Tá»± Ä‘á»™ng decompile cáº£ APK nguá»“n vÃ  Ä‘Ã­ch
- PhÃ¢n tÃ­ch cáº¥u trÃºc smali vÃ  tÃ­ch há»£p package vÃ o vá»‹ trÃ­ phÃ¹ há»£p
- Build, kÃ½ vÃ  tá»‘i Æ°u APK káº¿t quáº£
- CÃ i Ä‘áº·t vÃ  cháº¡y á»©ng dá»¥ng Ä‘á»ƒ kiá»ƒm tra tÃ­ch há»£p

### 4.3. TÃ­ch Há»£p Thá»§ CÃ´ng (Cho TrÆ°á»ng Há»£p Phá»©c Táº¡p)

#### 4.3.1. Decompile APK Nguá»“n vÃ  ÄÃ­ch
```bash
# Decompile APK nguá»“n vÃ  Ä‘Ã­ch
apktool d source.apk -o source_dir -f
apktool d target.apk -o target_dir -f
```

#### 4.3.2. TÃ¬m vÃ  Copy Package
```bash
# TÃ¬m package trong APK nguá»“n (vÃ­ dá»¥: com/example/feature)
# Copy package tá»« APK nguá»“n sang APK Ä‘Ã­ch, vÃ o Ä‘Ãºng thÆ° má»¥c smali
cp -r source_dir/smali/com/example/feature target_dir/smali/com/example/feature
```

#### 4.3.3. Cáº­p Nháº­t AndroidManifest.xml (Náº¿u Cáº§n)
Kiá»ƒm tra vÃ  cáº­p nháº­t cÃ¡c thÃ nh pháº§n cáº§n thiáº¿t trong AndroidManifest.xml

#### 4.3.4. Build, KÃ½ vÃ  CÃ i Äáº·t
```bash
# Build, kÃ½ vÃ  cÃ i Ä‘áº·t APK má»›i
apktool b target_dir -o new.apk
jarsigner -keystore keystore.jks new.apk alias_name
zipalign -p -f -v 4 new.apk aligned.apk
adb install -r aligned.apk
```

### 4.4. Kiá»ƒm Tra AndroidManifest.xml
- Há»‡ thá»‘ng tá»± Ä‘á»™ng kiá»ƒm tra xem package cáº§n tÃ­ch há»£p cÃ³ yÃªu cáº§u cáº­p nháº­t AndroidManifest.xml khÃ´ng
- Äá» xuáº¥t cÃ¡c thay Ä‘á»•i cáº§n thiáº¿t cho AndroidManifest.xml náº¿u cÃ³

### 4.5. Xá»­ LÃ½ Resources
- PhÃ¡t hiá»‡n vÃ  tÃ­ch há»£p resources liÃªn quan Ä‘áº¿n module
- Giáº£i quyáº¿t xung Ä‘á»™t resource ID náº¿u cÃ³

## 5. Cháº¡y VÃ  Kiá»ƒm Thá»­ APK

### 5.1. CÃ i Äáº·t APK VÃ o Thiáº¿t Bá»‹
- Há»‡ thá»‘ng tá»± Ä‘á»™ng cÃ i Ä‘áº·t APK Ä‘Ã£ kÃ½ vÃ o thiáº¿t bá»‹ Android Ä‘Ã£ káº¿t ná»‘i
- Há»— trá»£ cÃ i Ä‘áº·t trÃªn nhiá»u thiáº¿t bá»‹ náº¿u nhiá»u thiáº¿t bá»‹ Ä‘Æ°á»£c káº¿t ná»‘i

### 5.2. Cháº¡y APK Theo Package Name
- Tá»± Ä‘á»™ng láº¥y package name tá»« APK vÃ  cháº¡y á»©ng dá»¥ng
- Má»Ÿ activity chÃ­nh cá»§a á»©ng dá»¥ng thÃ´ng qua lá»‡nh ADB:
  ```bash
  adb shell monkey -p com.example.app -c android.intent.category.LAUNCHER 1
  ```

### 5.3. Theo DÃµi Log Khi Cháº¡y á»¨ng Dá»¥ng
- Há»‡ thá»‘ng tá»± Ä‘á»™ng lá»c vÃ  hiá»ƒn thá»‹ log cá»§a á»©ng dá»¥ng Ä‘á»ƒ phÃ¡t hiá»‡n lá»—i
- Sá»­ dá»¥ng cÃ¡c bá»™ lá»c tá»« cáº¥u hÃ¬nh .env Ä‘á»ƒ hiá»ƒn thá»‹ log cÃ³ liÃªn quan
  ```bash
  adb logcat | grep "com.example.app"
  ```

### 5.4. Äiá»u Khiá»ƒn á»¨ng Dá»¥ng TrÃªn Thiáº¿t Bá»‹
- Khá»Ÿi Ä‘á»™ng láº¡i á»©ng dá»¥ng khi cáº§n thiáº¿t
  ```bash
  adb shell am force-stop com.example.app
  adb shell monkey -p com.example.app -c android.intent.category.LAUNCHER 1
  ```
- Dá»«ng á»©ng dá»¥ng hoáº·c xÃ³a dá»¯ liá»‡u náº¿u cáº§n
  ```bash
  adb shell pm clear com.example.app
  ```
- Gá»¡ cÃ i Ä‘áº·t á»©ng dá»¥ng khi káº¿t thÃºc kiá»ƒm thá»­
  ```bash
  adb shell pm uninstall com.example.app
  ```

## 6. Quáº£n LÃ½ Backup VÃ  KhÃ´i Phá»¥c

### 6.1. Quick Backup
- Há»‡ thá»‘ng tá»± Ä‘á»™ng táº¡o backup trÆ°á»›c khi chá»‰nh sá»­a cÃ¡c file quan trá»ng
- Backup Ä‘Æ°á»£c lÆ°u trá»¯ vá»›i timestamp vÃ  mÃ´ táº£ cho dá»… tÃ¬m kiáº¿m sau nÃ y

### 6.2. KhÃ´i Phá»¥c Tá»« Backup
- Dá»… dÃ ng khÃ´i phá»¥c cÃ¡c file Ä‘Ã£ backup náº¿u cÃ³ lá»—i trong quÃ¡ trÃ¬nh chá»‰nh sá»­a
- Há»— trá»£ liá»‡t kÃª vÃ  so sÃ¡nh cÃ¡c phiÃªn báº£n backup

### 6.3. Dá»n Dáº¹p Backup CÅ©
- Tá»± Ä‘á»™ng dá»n dáº¹p cÃ¡c file backup cÅ© Ä‘á»ƒ tiáº¿t kiá»‡m khÃ´ng gian á»• Ä‘Ä©a
- Váº«n giá»¯ láº¡i cÃ¡c backup quan trá»ng Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u

## 7. Xá»­ LÃ½ Lá»—i Phá»• Biáº¿n

### 7.1. Lá»—i Decode APK
- Há»‡ thá»‘ng tá»± Ä‘á»™ng thá»­ vá»›i cÃ¡c phiÃªn báº£n apktool khÃ¡c nhau náº¿u gáº·p lá»—i
- Cung cáº¥p giáº£i phÃ¡p cho cÃ¡c lá»—i phá»• biáº¿n khi decode APK

### 7.2. Lá»—i Build APK
- PhÃ¢n tÃ­ch vÃ  Ä‘á» xuáº¥t giáº£i phÃ¡p cho lá»—i khi build APK
- Tá»± Ä‘á»™ng khÃ´i phá»¥c file tá»« backup náº¿u cáº§n

### 7.3. Lá»—i Khi Cháº¡y APK
- Theo dÃµi logcat Ä‘á»ƒ phÃ¡t hiá»‡n crash hoáº·c ANR
- Äá» xuáº¥t cÃ¡c giáº£i phÃ¡p dá»±a trÃªn phÃ¢n tÃ­ch log

## 8. TÃ­ch Há»£p Module Android Project

### 8.1. Build Module Tá»« Dá»± Ãn Android
- ***KIá»‚M TRA FILE .ENV TRÆ¯á»šC TIÃŠN*** - ThÃ´ng tin MODULE_ANDROID_PROJECT pháº£i Ä‘Æ°á»£c cáº¥u hÃ¬nh trong .env
- Tá»± Ä‘á»™ng build module APK tá»« dá»± Ã¡n Android chá»‰ Ä‘á»‹nh trong .env
- Chuáº©n bá»‹ module Ä‘á»ƒ tÃ­ch há»£p vÃ o APK Ä‘Ã­ch

### 8.2. TÃ­ch Há»£p Module VÃ o APK ÄÃ­ch
- TÃ­ch há»£p module Ä‘Ã£ build vÃ o APK Ä‘Ã­ch
- Tá»± Ä‘á»™ng xá»­ lÃ½ cÃ¡c váº¥n Ä‘á» tÃ­ch há»£p phá»• biáº¿n

## 9. LÆ°u Ã Quan Trá»ng

### 9.1. Báº£o ToÃ n Resource ID
- KhÃ´ng bao giá» thay Ä‘á»•i ID resource vÃ¬ nhiá»u module truy cáº­p resources thÃ´ng qua cÃ¡c phÆ°Æ¡ng thá»©c Ä‘á»™ng
- Nhiá»u á»©ng dá»¥ng sá»­ dá»¥ng getIdentifier() Ä‘á»ƒ láº¥y resource theo tÃªn:
  ```java
  resources.getIdentifier("drawable_name", "drawable", packageName)
  ```

### 9.2. Backup TrÆ°á»›c Khi Chá»‰nh Sá»­a
- LuÃ´n táº¡o backup trÆ°á»›c khi thá»±c hiá»‡n cÃ¡c thay Ä‘á»•i lá»›n
- Sá»­ dá»¥ng há»‡ thá»‘ng backup tá»± Ä‘á»™ng Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n

### 9.3. Kiá»ƒm Thá»­ Ká»¹ LÆ°á»¡ng
- Kiá»ƒm tra ká»¹ lÆ°á»¡ng APK sau khi chá»‰nh sá»­a trÃªn nhiá»u thiáº¿t bá»‹ khÃ¡c nhau
- Kiá»ƒm tra cáº£ chá»©c nÄƒng chÃ­nh vÃ  cÃ¡c tÃ­nh nÄƒng phá»¥

### 9.4. Theo DÃµi Log
- LuÃ´n kiá»ƒm tra log Ä‘á»ƒ phÃ¡t hiá»‡n lá»—i tiá»m áº©n
- Lá»c log Ä‘á»ƒ táº­p trung vÃ o thÃ´ng tin quan trá»ng

## 10. Xá»­ LÃ½ AndroidManifest.xml

### 10.1. Cáº¥u TrÃºc AndroidManifest.xml
```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.app">
    
    <!-- Permissions -->
    <uses-permission android:name="android.permission.INTERNET" />
    
    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme">
        
        <!-- Activities -->
        <activity
            android:name=".MainActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        
        <!-- Services -->
        <service
            android:name=".MyService"
            android:exported="false" />
            
        <!-- Receivers -->
        <receiver
            android:name=".MyReceiver"
            android:exported="false" />
            
    </application>
</manifest>
```

### 10.2. Quy Táº¯c Khi Chá»‰nh Sá»­a AndroidManifest.xml
- Tháº­n trá»ng khi thay Ä‘á»•i package name
- Giá»¯ nguyÃªn táº¥t cáº£ permission cáº§n thiáº¿t
- KhÃ´ng xÃ³a cÃ¡c component (activity, service, receiver) trá»« khi cháº¯c cháº¯n khÃ´ng cáº§n
- Äáº£m báº£o main activity Ä‘Æ°á»£c khai bÃ¡o Ä‘Ãºng vá»›i intent filter
- Kiá»ƒm tra cÃ¡c thuá»™c tÃ­nh android:exported cho cÃ¡c component

## 11. Máº«u File .env
```properties
# ÄÆ°á»ng dáº«n cÃ´ng cá»¥
BUNDLE_TOOL=/Users/trungkientn/Dev2/Mod/advanceapk/aab/bundletool.py

# ThÃ´ng tin keystore
KEYSTORE_PATH=/Users/trungkientn/Dev2/Mod/advanceapk/keystore/dev12345678.jks
KEYSTORE_PASSWORD=12345678
KEY_ALIAS=dev
KEY_PASSWORD=12345678

# ÄÆ°á»ng dáº«n dá»± Ã¡n
MODULE_ANDROID_PROJECT=/Users/trungkientn/Dev2/HuyDev/NewSdk2111
APK_PATH=apk

# ThÃ´ng tin package
DEFAULT_PACKAGE=com.example.app
LOG_FILTER=MyApp
```

## 12. CÃ¡c Lá»‡nh CÆ¡ Báº£n

### 12.0. Kiá»ƒm Tra .env (Báº®T BUá»˜C)
```bash
# Kiá»ƒm tra file .env
if [ ! -f ".env" ]; then
  echo "âŒ KhÃ´ng tÃ¬m tháº¥y file .env. Vui lÃ²ng táº¡o file .env tá»« template."
  exit 1
fi

# Load file .env
source .env

# Kiá»ƒm tra cÃ¡c thÃ´ng sá»‘ báº¯t buá»™c
echo "âœ… ÄÃ£ tÃ¬m tháº¥y vÃ  load file .env thÃ nh cÃ´ng"
```

### 12.1. PhÃ¢n TÃ­ch APK
```bash
aapt dump badging app.apk
```

### 12.2. Decode APK
```bash
apktool d app.apk -o output_dir -f
```

### 12.3. Build APK
```bash
apktool b modified_dir -o new.apk
```

### 12.4. KÃ½ APK
```bash
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore keystore.jks new.apk alias_name
```

### 12.5. Zipalign APK
```bash
zipalign -p -f -v 4 input.apk output.apk
```

### 12.6. CÃ i Äáº·t APK
```bash
adb install -r aligned.apk
```

### 12.7. Cháº¡y APK
```bash
adb shell monkey -p com.example.app -c android.intent.category.LAUNCHER 1
```

### 12.8. Xem Log
```bash
adb logcat | grep "com.example.app"
```

## 13. Script Kiá»ƒm Tra .env (Máº«u)

DÆ°á»›i Ä‘Ã¢y lÃ  script máº«u Ä‘á»ƒ kiá»ƒm tra file .env trong dá»± Ã¡n APK. ***Báº®T BUá»˜C*** sá»­ dá»¥ng script nÃ y hoáº·c tÆ°Æ¡ng tá»± á»Ÿ Ä‘áº§u má»i script lÃ m viá»‡c vá»›i APK:

```bash
#!/bin/bash

# MÃ u sáº¯c cho terminal
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
NC='\033[0m' # No Color

# HÃ m kiá»ƒm tra .env
check_env_file() {
  echo -e "${YELLOW}Äang kiá»ƒm tra file .env...${NC}"
  
  # Kiá»ƒm tra xem file .env cÃ³ tá»“n táº¡i khÃ´ng
  if [ ! -f ".env" ]; then
    echo -e "${RED}âŒ KHÃ”NG TÃŒM THáº¤Y FILE .ENV!${NC}"
    echo -e "${RED}ğŸ˜¡ TÃ´i khÃ´ng lÃ m viá»‡c náº¿u khÃ´ng cÃ³ file .env Ä‘Ãºng chuáº©n!${NC}"
    echo -e "${YELLOW}Vui lÃ²ng táº¡o file .env tá»« máº«u example.env vÃ  cáº¥u hÃ¬nh Ä‘Ãºng thÃ´ng tin.${NC}"
    return 1
  fi
  
  # Load file .env
  source .env
  
  # Kiá»ƒm tra cÃ¡c thÃ´ng sá»‘ báº¯t buá»™c
  missing_vars=()
  
  # Kiá»ƒm tra thÃ´ng tin keystore
  [ -z "$KEYSTORE_PATH" ] && missing_vars+=("KEYSTORE_PATH")
  [ -z "$KEYSTORE_PASSWORD" ] && missing_vars+=("KEYSTORE_PASSWORD") 
  [ -z "$KEY_ALIAS" ] && missing_vars+=("KEY_ALIAS")
  [ -z "$KEY_PASSWORD" ] && missing_vars+=("KEY_PASSWORD")
  
  # Kiá»ƒm tra thÃ´ng tin package
  [ -z "$DEFAULT_PACKAGE" ] && missing_vars+=("DEFAULT_PACKAGE")
  
  # Náº¿u cÃ³ biáº¿n thiáº¿u
  if [ ${#missing_vars[@]} -gt 0 ]; then
    echo -e "${RED}âŒ File .env thiáº¿u cÃ¡c thÃ´ng tin báº¯t buá»™c:${NC}"
    for var in "${missing_vars[@]}"; do
      echo -e "${RED}   - $var${NC}"
    done
    echo -e "${YELLOW}Vui lÃ²ng cáº­p nháº­t file .env vá»›i Ä‘áº§y Ä‘á»§ thÃ´ng tin.${NC}"
    return 1
  fi
  
  # Kiá»ƒm tra file keystore cÃ³ tá»“n táº¡i khÃ´ng
  if [ ! -f "$KEYSTORE_PATH" ]; then
    echo -e "${RED}âŒ File keystore khÃ´ng tá»“n táº¡i: $KEYSTORE_PATH${NC}"
    echo -e "${YELLOW}Vui lÃ²ng kiá»ƒm tra láº¡i Ä‘Æ°á»ng dáº«n keystore trong file .env.${NC}"
    return 1
  fi
  
  echo -e "${GREEN}âœ… File .env há»£p lá»‡. ÄÃ£ sáºµn sÃ ng lÃ m viá»‡c!${NC}"
  return 0
}

# Gá»i hÃ m kiá»ƒm tra .env
check_env_file || exit 1

# Tiáº¿p tá»¥c vá»›i cÃ¡c lá»‡nh khÃ¡c cá»§a script náº¿u .env há»£p lá»‡
echo -e "${GREEN}Báº¯t Ä‘áº§u thá»±c hiá»‡n cÃ´ng viá»‡c...${NC}"

## 14. LÆ°u Ã Cuá»‘i CÃ¹ng

### 14.1. NguyÃªn Táº¯c Tuyá»‡t Äá»‘i
- ğŸš¨ ***TUYá»†T Äá»I PHáº¢I*** kiá»ƒm tra vÃ  cáº¥u hÃ¬nh file .env trÆ°á»›c khi thá»±c hiá»‡n báº¥t ká»³ hoáº¡t Ä‘á»™ng nÃ o liÃªn quan Ä‘áº¿n APK
- ğŸš¨ ***TUYá»†T Äá»I KHÃ”NG*** bá» qua bÆ°á»›c kiá»ƒm tra .env vá»›i báº¥t ká»³ lÃ½ do gÃ¬
- ğŸš¨ ***TUYá»†T Äá»I TUÃ‚N THá»¦*** viá»‡c tá»« chá»‘i lÃ m viá»‡c náº¿u khÃ´ng cÃ³ file .env há»£p lá»‡
- ğŸš¨ ***TUYá»†T Äá»I Æ¯U TIÃŠN*** viá»‡c cáº¥u hÃ¬nh .env so vá»›i má»i bÆ°á»›c khÃ¡c trong quy trÃ¬nh

### 14.2 ThÃ´ng Äiá»‡p Äáº·c Biá»‡t

```
âš ï¸âš ï¸âš ï¸ Äá»ŒC Ká»¸ TRÆ¯á»šC KHI Báº®T Äáº¦U âš ï¸âš ï¸âš ï¸

ğŸ’» KHÃ”NG CÃ“ FILE .ENV = KHÃ”NG LÃ€M VIá»†C ğŸ’»

File .env lÃ  TRÃI TIM cá»§a má»i dá»± Ã¡n APK.
KhÃ´ng cÃ³ .env Ä‘Ãºng chuáº©n = khÃ´ng cÃ³ keystore = khÃ´ng thá»ƒ kÃ½ APK = APK khÃ´ng cÃ i Ä‘Æ°á»£c.

HÃ£y Ä‘áº£m báº£o báº¡n luÃ´n cÃ³ file .env Ä‘Ãºng chuáº©n trÆ°á»›c khi báº¯t Ä‘áº§u!